# 国内服务器网络问题

国内服务器网络问题主要指的是：
1. 我可以在 Windows 上通过梯子访问 github，但是 linux 服务器上运行的程序和脚本怎么办呢？
2. 我的 Docker Desktop 可以通过梯子访问 dockerhub 或者 quay.io，在 linux 服务器上的 docker 如何访问呢？

大体上解决这类问题的方案不外乎以下三种思路：一种是 proxy 代理，一种是 mirror 镜像，代理又分两种，普通网络代理和透明代理。

对这三个概念做简单的解释：

1. **普通代理**：需要手动设置 git/docker 客户端使用代理来中转流量，属于此类的方案举例：
	1. 通过 [nelvko/clash-for-linux-install](https://github.com/nelvko/clash-for-linux-install) 在 linux 启动 clash，然后配置 docker 代理。
	2. 启动一个 [registry](https://hub.docker.com/_/registry) 代理上游仓库，然后配置 `/etc/docker/daemon.json` 。
2. **mirror镜像**：相当于把国外的软件仓库（不一定是容器的仓库）复制一份到国内服务器，可能复制的不完全，通常也需要手动对客户端进行配置。
	1. 有的需要手动复制，比如腾讯云、阿里云的容器镜像仓库，或者你自己搭建的 registry 或 gitea 仓库。
	2. 有的是自动复制，比如[清华大学开源软件镜像站](https://mirrors.tuna.tsinghua.edu.cn/) ，会自动定期同步上游仓库。
	3. 有的是半自动，比如 [togettoyou/hub-mirror](https://github.com/togettoyou/hub-mirror) ，[tech-shrimp/docker_image_pusher](https://github.com/tech-shrimp/docker_image_pusher) 
3. **透明代理**：不需要手动设置客户端，强制转发流量，比如通过 openwrt 或者 TUN 实现。


>  这篇文章[如何优雅的给 Docker 配置网络代理 - CharyGao - 博客园](https://www.cnblogs.com/Chary/p/18096678) 详细说明了如何配置 docker 拉取镜像的代理、容器运行时的代理、容器构建时的代理和拉取镜像的mirror

